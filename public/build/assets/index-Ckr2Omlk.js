import{X as h,r as D,R as H,G as M,j as e,S as X}from"./app-CokYzS-F.js";import{T as $,F as z}from"./TestLayout-DUv21DNp.js";import{column as K}from"./column-Boh9JtYe.js";import{columnTanggungan as Q}from"./column-tanggungan-COaxvoNt.js";import{D as w}from"./DataTable-cPR4PY8E.js";import{I as C}from"./input-dHjaHlmq.js";import{L as d}from"./label-C_d9L4tp.js";import{B as j}from"./button-DXRGjYHm.js";import{D as U,a as W,b as Y,c as Z,d as ee,f as se}from"./dialog-DbdAoKxt.js";import{C as ae,a as re}from"./card-BKijC6qD.js";import{S as g,a as b,b as f,c as y,d as c}from"./select-Boj3KMCS.js";import{T as te,a as ie,b as k,c as P}from"./tabs-CvMIWAdy.js";import{D as le}from"./download-C7WzBBRN.js";import"./index-oHIwYT2J.js";import"./index-BR9r-2lB.js";import"./index-C8yMlqDe.js";import"./index-BLrSBiW6.js";import"./x-aa3kbx0y.js";import"./createLucideIcon-BkUXKyvH.js";import"./index-Dty0-HSw.js";import"./index-CsPfr4gY.js";import"./chevron-right-wTp0rLbP.js";import"./check-zEuZ_6mu.js";import"./chevrons-up-down-Qy9nBHWm.js";import"./logo stai-DC2AgwFL.js";import"./format-rupiah.esm-Dv-bfkK6.js";import"./arrow-up-down-D1flvOEB.js";import"./table-9aRnLclR.js";import"./chevron-down-BUAYtc6z.js";import"./search-Bl9aP4hy.js";const Je=({transaksi:v,mahasiswa:n,tanggungan_pembayaran:R})=>{const{flash:F}=h().props,{jenis_pembayaran:_}=h().props,{semesters:S}=h().props;console.log(F);const[V,p]=D.useState(!1),[ne,me]=H.useState(),{data:m,setData:o,post:B,processing:L,errors:r}=M({jenis_pembayaran_id:"",jumlah:"",deskripsi:"",semester_id:""}),E=s=>{s.preventDefault(),B(route("admin.bendahara.transaksi.store",n.id),{onSuccess:()=>{p(!1),console.log("Pembayaran berhasil")},onError:a=>{console.log(a)}})},I=s=>{const t=s.replace(/[^,\d]/g,"").toString().split(","),i=t[0].length%3;let l=t[0].substr(0,i);const T=t[0].substr(i).match(/\d{3}/gi);return T&&(l+=(i?".":"")+T.join(".")),l?`Rp. ${l}`:"Rp. "},O=s=>{const a=s.target.value.replace(/\D/g,"");o("jumlah",a)};[...v].sort((s,a)=>new Date(a.created_at).getTime()-new Date(s.created_at).getTime());const[x,A]=D.useState("all"),N=(s,a)=>a==="all"?s:s.filter(t=>{var i,l;return(l=(i=t.detail_jenis_pembayaran)==null?void 0:i.semester)!=null&&l.id?t.detail_jenis_pembayaran.semester.id.toString()===a:t.semester_id?t.semester_id.toString()===a:!1}),J=N(R,x),q=N(v,x),u=_.find(s=>s.id.toString()===m.jenis_pembayaran_id),G=u==null?void 0:u.is_once;return e.jsxs($,{children:[e.jsx(X,{title:"Riwayat Pembayaran"}),e.jsxs("div",{className:"md:max-w-full max-w-[350px]",children:[e.jsx("div",{className:"flex  flex-col md:flex-row mb-4",children:e.jsx(ae,{className:"w-full bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 shadow-md",children:e.jsx(re,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Riwayat Pembayaran"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 mr-3",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-gray-800",children:n.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["NIM: ",n==null?void 0:n.nim]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(g,{value:x,onValueChange:s=>A(s),children:[e.jsx(b,{className:"w-full md:w-[200px]",children:e.jsx(f,{placeholder:"Pilih Semester"})}),e.jsxs(y,{children:[e.jsx(c,{value:"all",children:"Semua Semester"}),S.map((s,a)=>e.jsxs(c,{value:s.id.toString(),children:[s.semester," ",s.tahun_ajaran]},a))]})]}),e.jsxs(U,{open:V,onOpenChange:p,children:[e.jsx(W,{asChild:!0,children:e.jsxs(j,{variant:"blue",children:[e.jsx(le,{className:"mr-2"}),"Tambah Pembayaran"]})}),e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsx(ee,{children:"Pengajuan Anggaran"})}),e.jsxs("form",{onSubmit:E,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{htmlFor:"jenis_pembayaran_id",children:"Jenis Pembayaran"}),e.jsxs(g,{value:m.jenis_pembayaran_id,onValueChange:s=>o("jenis_pembayaran_id",s),children:[e.jsx(b,{className:"w-full",children:e.jsx(f,{placeholder:"Pilih jenis pembayaran"})}),e.jsx(y,{children:_.map((s,a)=>e.jsx(c,{value:s.id.toString(),children:s.nama_pembayaran},a))})]}),r.jenis_pembayaran_id&&e.jsx("p",{className:"text-red-600",children:r.jenis_pembayaran_id})]}),!G&&e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{htmlFor:"semester_id",children:"Semester"}),e.jsxs(g,{value:m.semester_id,onValueChange:s=>o("semester_id",s),children:[e.jsx(b,{className:"w-full",children:e.jsx(f,{placeholder:"Pilih Semester"})}),e.jsx(y,{children:S.map((s,a)=>e.jsxs(c,{value:s.id.toString(),children:[s.semester," ",s.tahun_ajaran]},a))})]}),r.semester_id&&e.jsx("p",{className:"text-red-600",children:r.semester_id})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{htmlFor:"deskripsi",children:"Deskripsi"}),e.jsx(C,{id:"deskripsi",type:"text",value:m.deskripsi,onChange:s=>o("deskripsi",s.target.value)}),r.deskripsi&&e.jsx("p",{className:"text-red-500",children:r.deskripsi})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(d,{htmlFor:"jumlah",children:"Jumlah"}),e.jsx(C,{id:"jumlah",type:"text",value:I(m.jumlah),onChange:O,required:!0}),r.jumlah&&e.jsx("p",{className:"text-red-500",children:r.jumlah})]}),e.jsxs(se,{children:[e.jsx(j,{type:"submit",disabled:L,children:"Ajukan"}),e.jsx(j,{variant:"outline",onClick:()=>p(!1),children:"Batal"})]})]})]})]})]})]})})})}),e.jsx("div",{className:"mt-4 h-px bg-gray-200 w-full"})]}),e.jsxs(te,{defaultValue:"riwayat",className:"w-full",children:[e.jsxs(ie,{className:"grid w-full grid-cols-2",children:[e.jsx(k,{value:"riwayat",children:"Riwayat Transaksi"}),e.jsx(k,{value:"pembayaran",children:"Data Pembayaran"})]}),e.jsx(P,{value:"riwayat",children:e.jsx(w,{data:q,columns:K})}),e.jsx(P,{value:"pembayaran",children:e.jsx(w,{data:J,columns:Q})})]})]})};export{Je as default};
